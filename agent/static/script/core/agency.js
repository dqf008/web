define(["jquery","mutual","class","popup","clipboard","lang","cookie","utils","slick","numerator","waypoints","jquery-scrollbar"],function(a,b,c,d,e,f,g,h){var j,k=new d,l={parse:function(b){var c=a(b),d=c.data();return d.$el=c,d},handleEvents:function(a,b){var c=l[a.method];c&&"function"==typeof c&&c(a,b)},init:function(c,d){function f(){new b.AjaxThread({url:"ajax.php",data:"action=getstatistics",callback:function(b){for(var c in b)a(".j-detail").find('[data-name="'+c.toLowerCase()+'"]').text(b[c])}})}function g(b){var c=a(".j-member");c.find(".j-loading").show(),a.ajax({url:"ajax.php",data:{action:"getmymember",memberName:c.find("[name=account]").val()||"",page:b||1,agentId:p("__agent_ids__"),agentKey:p("__agent_key__"),type:c.find(".j-memberTypeValue").data("value")},type:"post",success:function(d){if(c.find(".j-onLoad").hide(),c.find(".j-table").find(".j-tbody").html(""),c.find(".j-loading").hide(),d.pageCount>0){var e=["username","fullName","regTime","loginTime","money","online","available"];$.each(d.list,function(a,b){var d="<tr>";$.each(e,function(a,c){d+="<td>","online"==c||"available"==c?d+=b[c]?'<i class="icon hook"></i>':'<i class="icon cross"></i>':("username"==c&&b["agent"]&&(d+='<span class="text-info">「代理」</span>'),d+=b[c]),d+="</td>"}),c.find(".j-table").find(".j-tbody").append(d+"</tr>")}),c.find(".j-inviteUser").on("click",function(){a.ajax({url:"ajax.php",data:{action:"invite",uid:a(this).data("uid")},type:"post",success:function(b){a(".j-p1").html(0==b.errorCode?"邀请成功":b.errorMsg).siblings().hide(),a(".d-tick").hide(),k.dialog({width:398,title:"系统提醒",content:a("#j-okjoin-main").get(0),fixed:!0,skin:"okjoin-dialog",okValue:"确定",ok:function(){}}).showModal()}})}),d.agents?c.find("[data-value=agent]").show():c.find("[data-value=agent]").hide(),d.rowCount>d.maxCount?(b&&1!=b||j({target:"j-member .j-pager",totalPages:d.pageCount,index:d.currentPage,callBack:function(a){g(a)}}),c.find(".j-pager").show()):c.find(".j-pager").hide(),c.find(".j-noData").hide()}else c.find(".j-noData").show(),c.find(".j-pager").hide()}})}function i(b){var c=a(".j-money"),d=c.find(".j-moneyTypeValue").data("value");c.find(".j-loading").show(),a.ajax({url:"ajax.php",data:{action:"getmembermoney",memberName:c.find("[name=account]").val()||"",page:b||1,days:c.find(".j-daysValue").data("value")||"",type:(d&&4==parseInt(d)?c.find(".j-otherTypeValue").data("value"):d)||1,agentId:p("__agent_ids__"),agentKey:p("__agent_key__")},type:"post",success:function(d){if(c.find(".j-onLoad").hide(),c.find(".j-table").find(".j-tbody").html(""),c.find(".j-loading").hide(),d.pageCount>0){var e=["username","orderId","orderTime","money","status"];$.each(d.list,function(a,b){var d="<tr>";$.each(e,function(c,e){d+="<td>",d+="status"==e?1==b[e]?'<i class="icon hook"></i>':0==b[e]?'<i class="icon cross"></i>':'<i class="icon reg-icon"></i>':"username"==e?'<a class="team-valid-bet j-moneyDetails" data-name="'+b["username"]+'" href="javascript:;">'+b["username"]+"</a>":"orderId"==e?'<a class="team-valid-bet j-orderDetails" data-index="'+a+'" href="javascript:;">'+b["orderId"]+"</a>":b[e],d+="</td>"}),c.find(".j-table").find(".j-tbody").append(d+"</tr>")}),c.find(".j-moneyDetails").on("click",function(){c.find("[name=account]").val(a(this).data("name")),i()}),c.find(".j-orderDetails").on("click",function(){var b=a(this).data("index");"undefined"!=typeof b&&(b=parseInt(b),k.dialog({width:700,title:"订单详细信息",content:a(".j-moneyDetailsDialog").get(0),fixed:!0,onshow:function(){a(".j-moneyDetailsDialog").find(".text-primary").each(function(){var c=a(this),e=c.data("key");e&&d.list[b][e]?c.text(d.list[b][e].replace(/<br[^>]*>/," / ")).parents(".info").show():c.parents(".info").hide()})},onbeforeremove:function(){}}))}),d.rowCount>d.maxCount?(b&&1!=b||j({target:"j-money .j-pager",totalPages:d.pageCount,index:d.currentPage,callBack:function(a){i(a)}}),c.find(".j-pager").show()):c.find(".j-pager").hide(),c.find(".j-totalCount").html(d.rowCount),c.find(".j-totalMoney").html(d.totalMoney),c.find(".j-total").show(),c.find(".j-noData").hide()}else c.find(".j-noData").show(),c.find(".j-pager, .j-total").hide()}})}function l(b){var c=a(".j-records"),d=c.find(".j-recordsValue").data("value");c.find(".j-loading").show(),a.ajax({url:"ajax.php",data:{action:"getmemberrecords",memberName:c.find("[name=account]").val()||"",page:b||1,days:c.find(".j-daysValue").data("value")||"",type:c.find(".j-records-"+d).find(".j-recordsTypeValue").data("value")||"",agentId:p("__agent_ids__"),agentKey:p("__agent_key__")},type:"post",success:function(d){if(c.find(".j-onLoad").hide(),c.find(".j-table").find(".j-tbody").html(""),c.find(".j-loading").hide(),d.pageCount>0){var e=["username","id","betTime","betAmount","netAmount","status"],f=!0;$.each(d.list,function(a,b){var d="<tr>";f="undefined"==typeof b["betTime"],$.each(e,function(c,e){d+="<td>",d+="username"==e?'<a class="team-valid-bet j-userDetails" data-name="'+b["username"]+'" href="javascript:;">'+b["username"]+"</a>":f&&"betTime"==e?b["createTime"]:"id"==e?'<a class="team-valid-bet j-orderDetails" data-index="'+a+'" href="javascript:;">'+b["id"]+"</a>":b[e],d+="</td>"}),c.find(".j-table").find(".j-tbody").append(d+"</tr>")}),c.find(".j-table").find("th[data-key=betTime]").text(f?"投注时间(美东)":"投注时间(美东/北京)"),c.find(".j-userDetails").on("click",function(){c.find("[name=account]").val(a(this).data("name")),l()}),c.find(".j-orderDetails").on("click",function(){var b=a(this).data("index");"undefined"!=typeof b&&(b=parseInt(b),k.dialog({width:700,title:"投注详细信息",content:a(".j-recordsDetailsDialog").get(0),fixed:!0,onshow:function(){a(".j-recordsDetailsDialog").find(".text-primary").each(function(){var c=a(this),e=c.data("key");e&&d.list[b][e]?"remark"==e?c.html(d.list[b][e]).parents(".info").show().prev().show():c.html(d.list[b][e].toString().replace(/<br[^>]*>/," / ")).parents(".info").show():"remark"==e?c.parents(".info").hide().prev().hide():c.parents(".info").hide()})},onbeforeremove:function(){}}))}),d.rowCount>d.maxCount?(b&&1!=b||j({target:"j-records .j-pager",totalPages:d.pageCount,index:d.currentPage,callBack:function(a){l(a)}}),c.find(".j-pager").show()):c.find(".j-pager").hide(),c.find(".j-noData").hide()}else c.find(".j-noData").show(),c.find(".j-pager").hide()}})}function m(b){var c=a(".j-reports");c.find(".j-recordsValue").data("value"),c.find(".j-loading").show(),a.ajax({url:"ajax.php",data:{action:"getreports",memberName:c.find("[name=account]").val()||"",page:b||1,days:c.find(".j-daysValue").data("value")||"",agentId:p("__agent_ids__"),agentKey:p("__agent_key__")},type:"post",success:function(d){if(c.find(".j-onLoad").hide(),c.find(".j-table").find(".j-tbody").html(""),c.find(".j-loading").hide(),c.find(".j-formula").html(d.formula),d.pageCount>0){var e=["username","reportTime","rowCount","betAmount","netAmount","validAmount","money"],f=!0;$.each(d.list,function(a,b){var d="<tr>";f="undefined"==typeof b["betTime"],$.each(e,function(c,e){d+="<td>",d+="username1"==e?'<a class="team-valid-bet j-userDetails" data-name="'+b["username"]+'" href="javascript:;">'+b["username"]+"</a>":"reportTime"==e?'<a class="team-valid-bet j-reportsDetails" data-index="'+a+'" href="javascript:;">'+b[e]+"</a>":b[e],d+="</td>"}),c.find(".j-table").find(".j-tbody").append(d+"</tr>")}),c.find(".j-total").show(),c.find(".j-totalBet").text(d.total.bet),c.find(".j-totalNet").text(d.total.net),c.find(".j-totalValid").text(d.total.valid),c.find(".j-totalCount").text(d.total.count),c.find(".j-totalMoney").text(d.total.money),c.find(".j-userDetails").on("click",function(){c.find("[name=account]").val(a(this).data("name")),m()}),c.find(".j-reportsDetails").on("click",function(){var b=a(this).data("index");"undefined"!=typeof b&&(b=parseInt(b),k.dialog({width:700,title:d.list[b]["reportTime"]+" 统计详情",content:a(".j-reportsDetailsDialog").get(0),fixed:!0,onshow:function(){var c=["rows_num","bet_amount","net_amount","valid_amount"],e=a(".j-reportsDetailsDialog").find(".j-team-tbody");e.empty(),$.each(d.list[b]["data"],function(a,b){var d="<tr><td>"+b["name"]+"</td>";$.each(c,function(a,c){d+="<td>"+b["data"][c]+"</td>"}),e.append(d+"</tr>")})},onbeforeremove:function(){}}))}),d.rowCount>d.maxCount?(b&&1!=b||j({target:"j-reports .j-pager",totalPages:d.pageCount,index:d.currentPage,callBack:function(a){m(a)}}),c.find(".j-pager").show()):c.find(".j-pager").hide(),c.find(".j-noData").hide()}else c.find(".j-total").hide(),c.find(".j-noData").show(),c.find(".j-pager").hide()}})}function n(b,c){b.find(".j-loading").show(),a.ajax({url:"ajax.php",data:{action:"getmyagent",memberName:b.find("[name=account]").val()||"",page:c||1,agentId:a(p("__agent_history__",[])).map(function(a,b){return b[0]}).get().join(",")},type:"post",success:function(a){if(b.find("[type=checkbox]").prop("checked",!1),b.find(".j-onLoad").hide(),b.find(".j-table").find(".j-tbody").html(""),b.find(".j-loading").hide(),a.pageCount>0){var d=["checkbox","username","fullName"],e=0,f=p("__child_agent__",{uid:[]}).uid;$.each(a.list,function(c,g){var h="<tr>";$.each(d,function(b,c){h+="<td>","checkbox"==c?(h+='<input type="checkbox" data-id="'+g["uid"]+'" ',h+='data-level="'+g["level"]+'" ',f.indexOf(g["uid"])>=0&&(h+='checked="true" ',e++),h+="/>"):h+="username"==c?a.agents?'<a class="team-valid-bet" data-id="'+g["uid"]+'" data-user="'+g["username"]+'" data-level="'+g["level"]+'" href="javascript:;">'+g["username"]+"</a>":g[c]:g[c],h+="</td>"}),b.find(".j-table").find(".j-tbody").append(h+"</tr>")}),e>0&&e==a.list.length&&b.find("[type=checkbox]").eq(0).prop("checked",!0),a.rowCount>a.maxCount?(c&&1!=c||j({target:"j-selectAgentDialog .j-pager",totalPages:a.pageCount,index:a.currentPage,callBack:function(a){n(b,a)}}),b.find(".j-pager").show()):b.find(".j-pager").hide(),b.find(".j-noData").hide()}else b.find(".j-noData").show(),b.find(".j-pager").hide()}})}function o(a,b){return sessionStorage.setItem(a,JSON.stringify(b))}function p(a,b){return JSON.parse(sessionStorage.getItem(a))||b}var q,r,s,t,u=c.init;switch(u){case"index":a("#slick").slick({arrows:!0,dots:!1,fade:!0,autoplay:!0,dots:!1,autoplaySpeed:6e3}),a(".j-infomation").slick({arrows:!1,vertical:!0,autoplay:!0,autoplaySpeed:3e3,infinite:!0,slidesToShow:3,slidesToScroll:3}),a(".numerator").each(function(){var b=a(this),c=b.data("num");b.numerator({toValue:c,onComplete:function(){b.text(c)}})}),a(window).scroll(function(){var b=a(window).scrollTop();b>850&&(a(".j-img1").show(200),a(".j-img2").show(300),a(".j-img3").show(400),a(".j-img4").show(500))}),a.fn.waypoint&&a(".main").waypoint(function(){a(".multi-platform").addClass("move")},{offset:"bottom-in-view"}),a("html").hasClass("lte-ie9")&&a("#j-login-form").find('input[name="MemberName"],input[name="Pwd"], input[name="checkCode"]').placeholder({labelMode:!0,labelStyle:{margin:"18px 0 0 -2px",left:"52px"},labelAlpha:!0}),r=!1,a("#j-join").click(function(){d.isLogin?0==d.testState&&0==d.memberState?(a(".j-join-d").show(),a(".modal-wrapper").animate({top:"40px"},500),a(".j-ok").on("click",function(){r||(r=!0,a.ajax({url:"ajax.php",data:{action:"apply",msg:q},type:"post",success:function(b){1==b.errorCode?k.dialog({width:550,title:"请填写申请理由",content:a(".j-joinUsDialog").get(0),fixed:!0,okValue:"确定",ok:function(){return q=a(".j-joinUsDialog").find("textarea").val(),q.length<20?(q="",a(".j-p1").html("请填写合适的申请理由").siblings().hide(),a(".d-tick").hide(),k.dialog({width:398,title:"系统提醒",content:a("#j-okjoin-main").get(0),fixed:!0,skin:"okjoin-dialog",okValue:"确定",ok:function(){}}).showModal(),!1):(a(".j-ok").trigger("click"),!0)}}):(a(".j-p1").text(b.errorMsg),0==b.errorCode?(a(".j-p1").siblings().show(),a(".d-tick").show()):(a(".j-p1").siblings().hide(),a(".d-tick").hide()),k.dialog({width:2==b.errorCode?450:398,title:"系统提醒",content:a("#j-okjoin-main").get(0),fixed:!0,skin:"okjoin-dialog",okValue:"确定",ok:function(){},onbeforeremove:function(){a(".j-join-d").hide(),0==b.errorCode&&location.reload()}}).showModal()),r=!1,q=""}}))})):2==d.testState?(a(".j-warn-p").text("试玩账号无法加入"),k.dialog({content:a("#j-warn-main").get(0),fixed:!0,skin:"warn-dialog",okValue:"确定",ok:function(){}}).showModal()):(a(".j-warn-p").text("账号已被冻结，请联系客服"),k.dialog({width:398,content:a("#j-warn-main").get(0),fixed:!0,skin:"warn-dialog",okValue:"确定",ok:function(){}}).showModal()):(a(".j-warn-p").text("请先登录"),k.dialog({content:a("#j-warn-main").get(0),fixed:!0,skin:"warn-dialog",okValue:"确定",ok:function(){}}).showModal())});break;case"mycommission":s=(new Date).getHours(),s>=6&&12>s?a(".j-time").html("早上好").fadeIn(500):s>=12&&18>s?a(".j-time").html("下午好").fadeIn(500):s>=18&&23>s&&a(".j-time").html("晚上好").fadeIn(500),setInterval(function(){h.heartbeat(b.cookieSetting.recommendStatistics,60,function(){f()})},5e3),a(".tab").click(function(){switch(a(this).addClass("active").siblings(".tab").removeClass("active"),a(this).siblings(".content").hide().eq(a(this).index()).show(),"promoLink"===a(this).data("name")?a("#j-promoLink").slideDown(500):a("#j-promoLink").slideUp(500),a(".j-selectAgent").html(p("__agent_msg__","点击选择下层代理")),a(this).index()){case 1:g();break;case 2:i();break;case 3:l();break;case 4:m()}}),a.support.opacity?(t=new e(".j-copy"),t.on("success",function(){k.msg("复制成功",1500)}),t.on("error",function(){k.msg("您的浏览器不支持复制功能，请手动复制！",1500)})):a(".j-copy").on("click",function(){k.msg("您的浏览器不支持复制功能，请手动复制！",1500)}),a(".j-selectAgent").on("click",function(){var b=a(".j-selectAgentDialog"),c=p("__agent_backup__",[]);c[0]&&(c[0].length>0?(b.find(".j-agentLevel").text(c[0][c[0].length-1][2]),b.find(".j-agentName").text(c[0][c[0].length-1][1]),b.find(".j-total").parent().removeClass("hide")):b.find(".j-total").parent().addClass("hide"),o("__agent_history__",c[0])),c[1]&&o("__child_agent__",c[1]),k.dialog({width:700,title:"选择下层代理",content:b.get(0),fixed:!0,onshow:function(){b.find("[type=button]").on("click",function(){var c,d,e,f,g=a(this);g.hasClass("j-confirm")?(c=[],d=p("__agent_history__",[]),e=a(d).map(function(a,b){return b[0]}).get(),f=p("__child_agent__",{uid:[]}),e.length>0&&c.push(e.join(",")),f.uid.length>0&&c.push(f.uid.join("|")),c=c.join(","),g.hide().siblings("span").show(),a.ajax({url:"ajax.php",data:{action:"getagentskey",agentId:c},type:"post",success:function(e){var h,i=a(".j-selectAgent");g.show().siblings("span").hide(),0==e.errorCode?(h=""==e.errorMsg?"点击选择下层代理":'当前位置：<span class="text-info">「第'+(f.uid.length>0?f.level:b.find(".j-total .j-agentLevel").text())+'层」</span><span class="text-primary">'+(f.uid.length>0?"共"+f.uid.length+"位代理":b.find(".j-total .j-agentName").text())+"</span>",i.html(h),o("__agent_backup__",[d,f]),o("__agent_key__",e.errorMsg),o("__agent_ids__",c),o("__agent_msg__",h),a(".tab.active").trigger("click"),b.parents(".art-dialog").find(".art-dialog-close").trigger("click")):k.msg(e.errorMsg,1500)}})):n(b)}),b.on("click",".j-tbody .team-valid-bet",function(){var c=a(this),d=b.find(".j-total").parent(),e=p("__agent_history__",[]);o("__child_agent__",null),e.push([c.data("id"),c.data("user"),c.data("level")]),d.find(".j-agentLevel").text(c.data("level")),d.find(".j-agentName").text(c.data("user")),o("__agent_history__",e),d.removeClass("hide"),n(b)}),b.on("click",".j-total .team-valid-bet",function(){var a=b.find(".j-total").parent(),c=p("__agent_history__",[]);o("__child_agent__",null),c.length>0&&(c.length--,c.length>0?(a.find(".j-agentLevel").text(c[c.length-1][2]),a.find(".j-agentName").text(c[c.length-1][1])):a.addClass("hide"),o("__agent_history__",c)),n(b)}),b.on("click","[type=checkbox]",function(){var c=a(this),d=b.find("[type=checkbox]"),e=p("__child_agent__",{uid:[],level:0}),f=d.filter("[data-id]").data("level");"undefined"==typeof c.data("id")?d.prop("checked",c.is(":checked")):d.eq(0).prop("checked",d.filter("[data-id]").size()==d.filter("[data-id]:checked").size()),e.level!=f&&(e.uid=[]),e.level=f,d.filter("[data-id]").each(function(){var b=a(this),c=parseInt(b.data("id")),d=e.uid.indexOf(c);b.is(":checked")?0>d&&e.uid.push(c):d>=0&&e.uid.splice(d,1)}),o("__child_agent__",e)}),n(b)},onbeforeremove:function(){}})}),a(".j-member .j-search").on("click",function(){g()}),a(".j-member .j-memberType").find(".item").on("click",function(){var b=a(this);a(".j-member .j-memberTypeValue").data("value",b.data("value")).text(b.text()),g()}),a(".j-member .j-agentBack").on("click",function(){var b=a(this),c=a(".j-member .j-memberType").find(".item").eq(0);b.parents("div.info").addClass("hide"),a(".j-member [name=account]").val(""),a(".j-member .j-memberTypeValue").data("value",c.data("value")).removeData("ids").text(c.text()),g()}),a(".j-money .j-search").on("click",function(){i()}),a(".j-money .dropdown").find(".list .item").on("click",function(){var b=a(this),c=a(".j-money .j-dropdown").filter(".ml15"),d=c.find(".item").eq(0);b.parent().siblings("[data-value]").data("value",b.data("value")).text(b.text()),b.parents(".dropdown").hasClass("j-dropdown")&&(parseInt(b.data("value"))>=4?c.show():(c.hide(),d.parent().siblings("[data-value]").data("value",d.data("value")).text(d.text()))),i()}),a(".j-records .j-search").on("click",function(){l()}),a(".j-records .dropdown").find(".list .item").on("click",function(){var b=a(this),c=b.parents(".dropdown").siblings(".dropdown").not(".j-dropdown");b.parent().siblings("[data-value]").data("value",b.data("value")).text(b.text()),b.parents(".dropdown").hasClass("j-dropdown")&&c.filter(".j-records-"+b.data("value")).is(":hidden")&&(c.each(function(){var b=a(this).find(".item").eq(0);b.parent().siblings("[data-value]").data("value",b.data("value")).text(b.text())}),c.filter(".j-records-"+b.data("value")).show().siblings(".dropdown").not(".j-dropdown").hide()),l()}),a(".j-reports .j-search").on("click",function(){m()}),a(".j-reports .j-dropdown").find(".item").on("click",function(){var b=a(this);a(".j-reports .j-daysValue").data("value",b.data("value")).text(b.text()),m()})}}},m=c.create({initialize:function(b){var c=this;this.options=a.extend(!0,{},b),a(function(){a(document).on("click","[data-click]",function(a){a.preventDefault();var b=l.parse(this);b.method=b.click,l.handleEvents(b,a)}),a(document).on("hover","[data-hover]",function(a){a.preventDefault();var b=l.parse(this);b.method=b.hover,l.handleEvents(b)}),a(document).on("change","[data-change]",function(a){a.preventDefault();var b=l.parse(this);b.method=b.change,l.handleEvents(b)}),a(document).on("blur","[data-blur]",function(a){a.preventDefault();var b=l.parse(this);b.method=b.blur,l.handleEvents(b)}),a("[data-plugin]").each(function(){var a=l.parse(this);l.render(a)}),a("[data-init]").each(function(){var a=l.parse(this);l.init(a,c.options)}),c.registerEvents()})},fixIE:function(){if(a("html").hasClass("lte-ie9")&&a.fn.placeholder){var b=a("#account-form").find('input[name="pwd"]'),c=b.data("options");c&&a("#account-form").find('input[name="pwd"]').placeholder({labelMode:!0,labelStyle:{margin:c.margin,left:c.left,color:c.color,"font-size":c.fontSize}})}},registerEvents:function(){a(".j-about").click(function(){a(".j-about-d").show(),a(".modal-wrapper").animate({top:"40px"},500)}),a.fn.scrollbar&&a(".scrollbar-inner").scrollbar(),a(".j-close").click(function(){a(".modal-wrapper").css({top:"800px"}),a(".j-join-d").hide(),a(".j-about-d").hide()}),a("#j-login").click(function(){k.dialog({width:370,title:" ",content:a("#j-login-main").get(0),fixed:!0,skin:"login-dialog",onshow:function(){var b=!1;a("#j-login-form").off("submit").on("submit",function(){if(!b){b=!0;var c=a(this),d=c.find(".j-warn"),e="";if(0==c.find(".account").val().length?e=f.tipsInputAccount:0==c.find(".pwd").val().length?e=f.tipsInputPassword:c.find(".pwd").val().length<6&&(e=f.tipsPswLengthError),showCheckcode()&&0==c.find(".checkcode").val().length&&(e=f.tipsInputCheckCode),e)return d.show().html('<i class="icon d-warn"></i>'+e),b=!1,!1;d.hide(),a.post("ajax.php",a("#j-login-form").serialize()+"&action=login&version=1.3",function(c){b=!1,c&&(c.errorCode?6==c.errorCode&&g("failCount")<2?(a("#j-login-form").find(".code-box").show(),e="您输入的密码已连续错误3次，请输入验证码",g("failCount",3)):(new n("vCodeImg"),self.showCheckcode(),e=c.errorMsg):c.isForzen?(a(".j-p1").text(c.errorMsg),a(".j-p1").siblings().hide(),a(".d-tick").hide(),k.dialog({width:398,title:"系统提醒",content:a("#j-okjoin-main").get(0),fixed:!0,skin:"okjoin-dialog",okValue:"确定",ok:function(){location.reload()}}).showModal()):(a("#j-success").show(),setTimeout(function(){location.reload()},500)),e&&d.show().html('<i class="icon d-warn"></i>'+e))})}})}}).showModal()}),showCheckcode=function(){var b=g("failCount");return!!(b&&b>2)&&(a("#j-login-form").find(".code-box").show(),!0)}}}),n=function(b){function c(a){d.options.img.attr("src",d.options.url+"?rand="+Math.random()),a&&a.val("")}var d,e,f;if(!this instanceof n)return new n(b);if(this.options={url:"../yzm.php",img:null,relation:null,loadImg:null,event:null},!b)throw Error("验证码对象参不存在");if("string"==typeof b?this.options.img=b:a.extend(this.options,b),!this.options.img)throw Error("验证码图片对象不存在");if(this.options.img=h.jq(this.options.img),d=this,this.options.relation)if(this.options.relation instanceof Array)for(f=0;f<this.options.relation.length;f++)e=h.jq(this.options.relation[f]),e&&(e.val(""),e.on("focus",function(){var b=a(this);"text"===b.attr("type")&&"none"==d.options.img.css("display")&&(b.attr("placeholder","").val(""),d.options.img.show(),c(b))}));else e=h.jq(this.options.relation),e.val(""),e.on("focus",function(){var b=a(this);"text"===b.attr("type")&&"none"==d.options.img.css("display")&&(b.attr("placeholder","").val(""),d.options.img.show(),c())});return this.options.img.on("click",function(){if(d.options.loadImg&&"string"==typeof d.options.loadImg){var b='<span id="chckloadingDiv" style="z-index: 1987;position: absolute;left: 0;top: -18px;width: 55px;height: 25px;line-height: 51px;text-align: center;background: #595959;opacity: 0.5;"><img style="bottom:4px;left:18px;" src="'+d.options.loadImg+'"></span>';a(this).before(b),c(),a(this).load(function(){a("#chckloadingDiv").remove()})}else c()}),this.options.img.is(":visible")&&c(),this};return n.prototype.Refresh=function(a){this.options.img.attr("src",this.options.url+"?rand="+Math.random()),a&&a.val("")},j=function(b){function c(a){var b=f(m),c=a-(b/2-1),d="";for(i=0;m>i;i++)d+='<li class="page">'+(c+i)+"</li>";k.find("ul").html(o.replace("{0}",d)),k.find("ul .page").eq(b/2-1).addClass(n)}function d(a){var b="";if(l>m-1)for(i=0;m>i;i++)b+='<li class="page">'+(i+1)+"</li>";else for(i=0;l>i;i++)b+='<li class="page">'+(i+1)+"</li>";k.find("ul").html(o.replace("{0}",b)),k.find("ul .page").eq(a).addClass(n)}function e(a){var b="";if(l>m-1)for(i=l-(m-1);l+1>i;i++)b+='<li class="page">'+i+"</li>";else for(i=0;l>i;i++)b+='<li class="page">'+(i+1)+"</li>";k.find("ul").html(o.replace("{0}",b)),k.find("ul .page").eq(a).addClass(n)}function f(a){var b=a%2;return 0==b?a:1==b?a+1:void 0}var g,h={target:"",totalPages:10,liNums:5,activeClass:"active",firstPage:"首页",lastPage:"末页",prv:"«",next:"»",hasFirstPage:!0,hasLastPage:!0,hasPrv:!0,hasNext:!0,callBack:function(){}},j=a.extend(h,b),k=a("."+j.target),l=j.totalPages,m=j.liNums,n=j.activeClass,o="{0}",p="",q='<li class="page '+n+'">1</li>';if(l>1&&m+1>l)for(i=2;l+1>i;i++)p+='<li class="page">'+i+"</li>";else if(l>m)for(i=2;m+1>i;i++)p+='<li class="page">'+i+"</li>";g=q+p,j.hasNext&&(o='<li class="prv">'+j.prv+"</li>"+o),j.hasPrv&&(o+='<li class="next">'+j.next+"</li>"),j.hasLastPage&&(o+='<li class="last">'+j.lastPage+"</li>"),j.hasFirstPage&&(o='<li class="first">'+j.firstPage+"</li>"+o),g='<ul class="pager">'+o.replace("{0}",g)+"</ul>",k.html(g).off("click"),k.on("click",".next",function(){var a,b,d=parseInt(k.find("."+n).html()),e=m%2;0==e?(a=m,b=!0):1==e&&(a=m+1,b=!1),d>=l||(d>0&&a/2>=d?k.find("."+n).removeClass(n).next().addClass(n):d>l-a/2&&l>d&&0==b||d>l-a/2-1&&l>d&&1==b?k.find("."+n).removeClass(n).next().addClass(n):(k.find("."+n).removeClass(n).next().addClass(n),c(d+1)),j.callBack(d+1))}),k.on("click",".prv",function(){var a=parseInt(k.find("."+n).html()),b=f(m);1>=a||(a>1&&b/2>=a||a>l-b/2&&l+1>a?k.find("."+n).removeClass(n).prev().addClass(n):(k.find("."+n).removeClass(n).prev().addClass(n),c(a-1)),j.callBack(a-1))}),k.on("click",".first",function(){var a=parseInt(k.find("."+n).html());1>=a||(j.callBack(1),d(0))}),k.on("click",".last",function(){var a=parseInt(k.find("."+n).html());a>=l||(j.callBack(l),e(l>m?m-1:l-1))}),k.on("click",".page",function(){var b=a(this),g=parseInt(b.html()),h=f(m);j.callBack(g),l>m?g>l-h/2&&l+1>g?e(m-1-(l-g)):g>0&&h/2>g?d(g-1):c(g):(k.find("."+n).removeClass(n),b.addClass(n))})},m});